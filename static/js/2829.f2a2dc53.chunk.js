"use strict";(self.webpackChunkapp_frontend=self.webpackChunkapp_frontend||[]).push([[2829],{31848:function(e,t,n){var s={selectLoading:(0,n(76747).P1)([function(e){return e.record.destroy}],(function(e){return Boolean(e.loading)}))};t.Z=s},90462:function(e,t,n){var s=n(76747),r=n(86495),a=n(26319),o=n(71945),l=(0,s.P1)([r.Z.selectCurrentTenant,r.Z.selectCurrentUser],(function(e,t){return new a.Z(e,t).match(o.Z.values.couponsRead)})),i=(0,s.P1)([r.Z.selectCurrentTenant,r.Z.selectCurrentUser],(function(e,t){return new a.Z(e,t).match(o.Z.values.couponsEdit)})),c=(0,s.P1)([r.Z.selectCurrentTenant,r.Z.selectCurrentUser],(function(e,t){return new a.Z(e,t).match(o.Z.values.couponsCreate)})),d=(0,s.P1)([r.Z.selectCurrentTenant,r.Z.selectCurrentUser],(function(e,t){return new a.Z(e,t).match(o.Z.values.couponsImport)})),u={selectPermissionToRead:l,selectPermissionToEdit:i,selectPermissionToCreate:c,selectPermissionToDestroy:(0,s.P1)([r.Z.selectCurrentTenant,r.Z.selectCurrentUser],(function(e,t){return new a.Z(e,t).match(o.Z.values.couponsDestroy)})),selectPermissionToImport:d};t.Z=u},15021:function(e,t,n){var s=n(76747),r=n(86495),a=n(26319),o=n(71945),l=(0,s.P1)([r.Z.selectCurrentTenant,r.Z.selectCurrentUser],(function(e,t){return new a.Z(e,t).match(o.Z.values.userRead)})),i=(0,s.P1)([r.Z.selectCurrentTenant,r.Z.selectCurrentUser],(function(e,t){return new a.Z(e,t).match(o.Z.values.userEdit)})),c=(0,s.P1)([r.Z.selectCurrentTenant,r.Z.selectCurrentUser],(function(e,t){return new a.Z(e,t).match(o.Z.values.userDestroy)})),d={selectPermissionToRead:l,selectPermissionToEdit:i,selectPermissionToCreate:(0,s.P1)([r.Z.selectCurrentTenant,r.Z.selectCurrentUser],(function(e,t){return new a.Z(e,t).match(o.Z.values.userCreate)})),selectPermissionToImport:(0,s.P1)([r.Z.selectCurrentTenant,r.Z.selectCurrentUser],(function(e,t){return new a.Z(e,t).match(o.Z.values.userImport)})),selectPermissionToDestroy:c};t.Z=d},72829:function(e,t,n){n.r(t),n.d(t,{default:function(){return J}});var s=n(47313),r=n(10499),a=n(1413),o=n(70885),l=n(78940),i=n(78589),c=n(45788),d=n(43270),u=n(47590),m=n(95748),h=n(69138),x=n(6473),f=n(67357),Z=n(13586),b=n(40846),j=n(5544),p=n(18245),v=n(68031),g=n(75454),N=n(21538),C=n(46417),y=x.Ry().shape({user:u.Z.relationToOne((0,r.ag)("entities.record.fields.user")),product:u.Z.relationToOne((0,r.ag)("entities.record.fields.product")),number:u.Z.decimal((0,r.ag)("entities.record.fields.number")),status:u.Z.enumerator((0,r.ag)("entities.record.fields.status"))}),w={user:null,product:null,number:null,status:null},T={user:{label:(0,r.ag)("entities.record.fields.user"),render:b.Z.relationToOne()},product:{label:(0,r.ag)("entities.record.fields.product"),render:b.Z.relationToOne()},number:{label:(0,r.ag)("entities.record.fields.number"),render:b.Z.decimal()},status:{label:(0,r.ag)("entities.record.fields.status"),render:b.Z.enumerator("entities.record.enumerators.status")}};var P=function(e){var t=(0,c.v9)(i.Z.selectRawFilter),n=(0,c.I0)(),u=(0,s.useState)(!1),x=(0,o.Z)(u,2),b=x[0],P=x[1],k=(0,s.useState)((function(){return(0,a.Z)((0,a.Z)({},w),t)})),S=(0,o.Z)(k,1)[0],R=(0,d.cI)({resolver:(0,f.X)(y),defaultValues:S,mode:"all"});(0,s.useEffect)((function(){n(l.Z.doFetch(y.cast(S),t))}),[n]);var U=function(e){var t=R.getValues();n(l.Z.doFetch(e,t)),P(!1)};return(0,C.jsxs)(h.Z,{children:[(0,C.jsx)(Z.Z,{onClick:function(){P(!b)},renders:T,values:t,expanded:b,onRemove:function(e){return R.setValue(e,w[e]),R.handleSubmit(U)()}}),(0,C.jsx)("div",{className:"container",children:(0,C.jsx)("div",{className:"collapse ".concat(b?"show":""),children:(0,C.jsx)(d.RV,(0,a.Z)((0,a.Z)({},R),{},{children:(0,C.jsxs)("form",{onSubmit:R.handleSubmit(U),children:[(0,C.jsxs)("div",{className:"row",children:[(0,C.jsx)("div",{className:"col-lg-6 col-12",children:(0,C.jsx)(v.Z,{name:"user",label:(0,r.ag)("entities.record.fields.user")})}),(0,C.jsx)("div",{className:"col-lg-6 col-12",children:(0,C.jsx)(g.Z,{name:"product",label:(0,r.ag)("entities.record.fields.product")})}),(0,C.jsx)("div",{className:"col-lg-6 col-12",children:(0,C.jsx)(N.Z,{name:"number",label:(0,r.ag)("entities.record.fields.number")})}),(0,C.jsx)("div",{className:"col-lg-6 col-12",children:(0,C.jsx)(j.Z,{name:"status",label:(0,r.ag)("entities.record.fields.status"),options:p.Z.status.map((function(e){return{value:e,label:(0,r.ag)("entities.record.enumerators.status.".concat(e))}}))})})]}),(0,C.jsx)("div",{className:"row",children:(0,C.jsxs)("div",{className:"col-12 filter-buttons",children:[(0,C.jsxs)("button",{className:"btn btn-primary",type:"submit",disabled:e.loading,children:[(0,C.jsx)(m.Z,{loading:e.loading,iconClass:"fas fa-search"}),(0,r.ag)("common.search")]}),(0,C.jsxs)("button",{className:"btn btn-light",type:"button",onClick:function(){Object.keys(w).forEach((function(e){R.setValue(e,w[e])})),n(l.Z.doReset()),P(!1)},disabled:e.loading,children:[(0,C.jsx)(m.Z,{loading:e.loading,iconClass:"fas fa-undo"}),(0,r.ag)("common.reset")]})]})})]})}))})})]})},k=n(28303),S=n(90462),R=n(65187),U=n(31848),E=n(98848),A=n(44587),I=n(61567),D=n(27216),F=n(97249),L=(n(63667),n(1296)),O=n(4694);var V=function(e){var t=(0,c.v9)(O.Z.selectPermissionToRead),n=function(){var t=e.value;return t?Array.isArray(t)?t:[t]:[]};return n().length?(0,C.jsx)(C.Fragment,{children:n().map((function(e){return n=e,t?(0,C.jsx)("div",{children:(0,C.jsx)(k.rU,{className:"btn btn-link",to:"/product/".concat(n.id),children:n.title})},n.id):(0,C.jsx)("div",{children:n.title},n.id);var n}))}):null};var $=function(e){var t=(0,s.useState)(null),n=(0,o.Z)(t,2),a=n[0],d=n[1],u=(0,c.I0)(),m=(0,c.v9)(i.Z.selectLoading),h=(0,c.v9)(U.Z.selectLoading),x=m||h,f=(0,c.v9)(i.Z.selectRows),Z=(0,c.v9)(i.Z.selectPagination),b=(0,c.v9)(i.Z.selectSelectedKeys),j=(0,c.v9)(i.Z.selectHasRows),p=(0,c.v9)(i.Z.selectSorter),v=(0,c.v9)(i.Z.selectIsAllSelected),g=(0,c.v9)(S.Z.selectPermissionToEdit),N=(0,c.v9)(S.Z.selectPermissionToDestroy),y=function(){d(null)},w=function(e){var t=p.field===e&&"ascend"===p.order?"descend":"ascend";u(l.Z.doChangeSort({field:e,order:t}))},T=function(e){switch(e){case"pending":return"pending";case"canceled":return"canceled";default:return"completed"}};return(0,C.jsxs)(D.Z,{children:[(0,C.jsx)("div",{className:"table-responsive",children:(0,C.jsxs)("table",{className:"table table-striped     mt-2",children:[(0,C.jsx)("thead",{className:"thead",children:(0,C.jsxs)("tr",{children:[(0,C.jsx)(E.Z,{className:"th-checkbox",children:j&&(0,C.jsxs)("div",{className:"adherent-control adherent-checkbox",children:[(0,C.jsx)("input",{type:"checkbox",className:"adherent-control-input",id:"table-header-checkbox",checked:Boolean(v),onChange:function(){u(l.Z.doToggleAllSelected())}}),(0,C.jsx)("label",{htmlFor:"table-header-checkbox",className:"adherent-control-label",children:"\xa0"})]})}),(0,C.jsx)(E.Z,{onSort:w,hasRows:j,sorter:p,name:"title",label:(0,r.ag)("entities.record.fields.user")}),(0,C.jsx)(E.Z,{onSort:w,hasRows:j,sorter:p,name:"type",label:(0,r.ag)("entities.record.fields.product")}),(0,C.jsx)(E.Z,{onSort:w,hasRows:j,sorter:p,name:"noOfTimes",label:(0,r.ag)("entities.record.fields.number"),align:"right"}),(0,C.jsx)(E.Z,{onSort:w,hasRows:j,sorter:p,name:"discount",label:(0,r.ag)("entities.record.fields.status"),align:"right"}),(0,C.jsx)(E.Z,{className:"th-actions"})]})}),(0,C.jsxs)("tbody",{children:[x&&(0,C.jsx)("tr",{children:(0,C.jsx)("td",{colSpan:100,children:(0,C.jsx)(I.Z,{})})}),!x&&!j&&(0,C.jsx)("tr",{children:(0,C.jsx)("td",{colSpan:100,children:(0,C.jsx)("div",{className:"d-flex justify-content-center",children:(0,r.ag)("table.noData")})})}),!x&&f.map((function(e){return(0,C.jsxs)("tr",{children:[(0,C.jsx)("th",{className:"th-checkbox",scope:"row",children:(0,C.jsxs)("div",{className:"adherent-control adherent-checkbox",children:[(0,C.jsx)("input",{type:"checkbox",className:"adherent-control-input",id:"table-header-checkbox-".concat(e.id),checked:b.includes(e.id),onChange:function(){return t=e.id,void u(l.Z.doToggleOneSelected(t));var t}}),(0,C.jsx)("label",{htmlFor:"table-header-checkbox-".concat(e.id),className:"adherent-control-label",children:"\xa0"})]})}),(0,C.jsx)("td",{style:{textAlign:"center"},children:(0,C.jsx)(L.Z,{value:e.user})}),(0,C.jsx)("td",{style:{textAlign:"center"},children:(0,C.jsx)(V,{value:e.product})}),(0,C.jsx)("td",{style:{textAlign:"center"},children:e.number}),(0,C.jsx)("td",{style:{textAlign:"center"},children:(0,C.jsxs)("span",{className:T(e.status),children:["  ",e.status]})}),(0,C.jsxs)("td",{className:"td-actions",children:[(0,C.jsx)(k.rU,{className:"btn btn-link",to:"/record/".concat(e.id),children:(0,r.ag)("common.view")}),g&&(0,C.jsx)(k.rU,{className:"btn btn-link",to:"/record/".concat(e.id,"/edit"),children:(0,r.ag)("common.edit")}),N&&(0,C.jsx)("button",{className:"btn btn-link",type:"button",onClick:function(){return t=e.id,void d(t);var t},children:(0,r.ag)("common.destroy")})]})]},e.id)}))]})]})}),(0,C.jsx)(F.Z,{onChange:function(e){u(l.Z.doChangePagination(e))},disabled:x,pagination:Z}),a&&(0,C.jsx)(A.Z,{title:(0,r.ag)("common.areYouSure"),onConfirm:function(){return e=a,y(),void u(R.Z.doDestroy(e));var e},onClose:function(){return y()},okText:(0,r.ag)("common.yes"),cancelText:(0,r.ag)("common.no")})]})},B=n(23516),H=n(10419),K=n(28745);var M=function(e){var t=(0,s.useState)(!1),n=(0,o.Z)(t,2),a=n[0],d=n[1],u=(0,c.I0)(),h=(0,c.v9)(i.Z.selectSelectedKeys),x=(0,c.v9)(i.Z.selectLoading),f=(0,c.v9)(U.Z.selectLoading),Z=(0,c.v9)(i.Z.selectExportLoading),b=(0,c.v9)(i.Z.selectHasRows),j=(0,c.v9)(B.Z.selectPermissionToRead),p=(0,c.v9)(S.Z.selectPermissionToDestroy),v=(0,c.v9)(S.Z.selectPermissionToCreate),g=(0,c.v9)(S.Z.selectPermissionToImport),N=function(){d(!0)},y=function(){d(!1)},w=function(){u(l.Z.doExport())};return(0,C.jsxs)(H.Z,{children:[v&&(0,C.jsx)(k.rU,{to:"/record/new",children:(0,C.jsxs)("span",{"data-tip":(0,r.ag)("common.new"),"data-for":"charge-list-toolbar-new-tooltip",children:[(0,C.jsx)("button",{className:"btn btn-primary",type:"button",children:(0,C.jsx)(m.Z,{iconClass:"fas fa-plus"})}),(0,C.jsx)(K.Z,{id:"charge-list-toolbar-new-tooltip"})]})}),g&&(0,C.jsx)(k.rU,{to:"/record/importer",children:(0,C.jsxs)("span",{"data-tip":(0,r.ag)("common.import"),"data-for":"charge-list-toolbar-import-tooltip",children:[(0,C.jsx)("button",{className:"btn btn-primary",type:"button",children:(0,C.jsx)(m.Z,{iconClass:"fas fa-upload"})}),(0,C.jsx)(K.Z,{id:"charge-list-toolbar-import-tooltip"})]})}),function(){if(!p)return null;var e=!h.length||x,t=(0,C.jsx)("button",{disabled:e,className:"btn btn-primary",type:"button",onClick:N,children:(0,C.jsx)(m.Z,{loading:f,iconClass:"far fa-trash-alt"})});return e?(0,C.jsxs)("span",{"data-tip":(0,r.ag)("common.mustSelectARow"),"data-tip-disable":!e,"data-for":"coupons-list-toolbar-destroy-tooltip",children:[t,(0,C.jsx)(K.Z,{id:"coupons-list-toolbar-destroy-tooltip"})]}):t}(),j&&(0,C.jsx)(k.rU,{to:"/audit-logs?entityNames=coupons",children:(0,C.jsxs)("span",{"data-tip":(0,r.ag)("auditLog.menu"),"data-for":"charge-list-toolbar-auditLog-tooltip",children:[(0,C.jsx)("button",{className:"btnCircle btn-light",type:"button",children:(0,C.jsx)(m.Z,{iconClass:"fas fa-history"})}),(0,C.jsx)(K.Z,{id:"charge-list-toolbar-auditLog-tooltip"})]})}),function(){var e=!b||x,t=(0,C.jsxs)("span",{"data-tip":(0,r.ag)("common.export"),"data-for":"charge-list-toolbar-export",children:[(0,C.jsx)("button",{className:"btnCircle btn-light",disabled:e,onClick:w,type:"button",children:(0,C.jsx)(m.Z,{loading:Z,iconClass:"far fa-file-excel"})}),(0,C.jsx)(K.Z,{id:"charge-list-toolbar-export"})]});return e?(0,C.jsxs)("span",{"data-tip":(0,r.ag)("common.noDataToExport"),"data-tip-disable":!e,"data-for":"coupons-list-toolbar-export-tooltip",children:[t,(0,C.jsx)(K.Z,{id:"coupons-list-toolbar-export-tooltip"})]}):t}(),a&&(0,C.jsx)(A.Z,{title:(0,r.ag)("common.areYouSure"),onConfirm:function(){return y(),void u(R.Z.doDestroyAll(h))},onClose:function(){return y()},okText:(0,r.ag)("common.yes"),cancelText:(0,r.ag)("common.no")})]})},Y=n(27829),_=n(53852),G=n(75352),X=n(22102),q=n(63849),z=n(31616);var J=function(e){return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(_.Z,{items:[[(0,r.ag)("dashboard.menu"),"/"],[(0,r.ag)("entities.record.menu")]]}),(0,C.jsxs)(Y.Z,{children:[(0,C.jsx)(X.Z,{fluid:!0,children:(0,C.jsxs)(q.Z,{children:[(0,C.jsx)(z.Z,{xs:9,children:(0,C.jsx)(G.Z,{children:(0,r.ag)("entities.record.list.title")})}),(0,C.jsx)(z.Z,{md:"auto",children:(0,C.jsx)(M,{})})]})}),(0,C.jsx)(P,{}),(0,C.jsx)($,{})]})]})}},44587:function(e,t,n){var s=n(47313),r=n(1168),a=n(46417);t.Z=function(e){var t=(0,s.useRef)();(0,s.useEffect)((function(){window.$(t.current).modal("show"),window.$(t.current).on("hidden.bs.modal",e.onClose)}),[]);return r.createPortal((0,a.jsx)("div",{ref:t,className:"modal",tabIndex:-1,children:(0,a.jsx)("div",{className:"modal-dialog modal-sm",children:(0,a.jsxs)("div",{className:"modal-content",children:[(0,a.jsxs)("div",{className:"modal-header",children:[(0,a.jsx)("h5",{className:"modal-title",children:e.title}),(0,a.jsx)("button",{type:"button",className:"close","data-dismiss":"modal",children:(0,a.jsx)("span",{children:"\xd7"})})]}),(0,a.jsxs)("div",{className:"modal-footer",children:[(0,a.jsx)("button",{type:"button",className:"btn btn-light btn-sm","data-dismiss":"modal",children:e.cancelText}),(0,a.jsx)("button",{type:"button",onClick:function(){return window.$(t.current).modal("hide"),e.onConfirm()},className:"btn btn-primary btn-sm",children:e.okText})]})]})})}),document.getElementById("modal-root"))}},68031:function(e,t,n){n.d(t,{Z:function(){return v}});var s=n(1413),r=n(42982),a=n(70885),o=n(47313),l=n(74773),i=n(74165),c=n(15861),d=n(1168),u=n(10499),m=n(99433),h=n(33512),x=n(46417);var f=function(e){var t=(0,o.useRef)(),n=(0,o.useState)(!1),s=(0,a.Z)(n,2),r=s[0],f=s[1];(0,o.useEffect)((function(){window.$(t.current).modal("show"),window.$(t.current).on("hidden.bs.modal",e.onClose)}),[]);var Z=function(){var n=(0,c.Z)((0,i.Z)().mark((function n(s,r){var a,o;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,f(!0),n.next=4,l.Z.create(r);case 4:return n.next=6,l.Z.fetchUsers({email:r.emails[0]},null,1,0);case 6:a=n.sent,o=a.rows,window.$(t.current).modal("hide"),e.onSuccess(o[0]),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(0),h.Z.handle(n.t0);case 15:return n.prev=15,f(!1),n.finish(15);case 18:case"end":return n.stop()}}),n,null,[[0,12,15,18]])})));return function(e,t){return n.apply(this,arguments)}}();return d.createPortal((0,x.jsx)("div",{ref:t,className:"modal",tabIndex:-1,children:(0,x.jsx)("div",{className:"modal-dialog modal-lg",children:(0,x.jsxs)("div",{className:"modal-content",children:[(0,x.jsxs)("div",{className:"modal-header",children:[(0,x.jsx)("h5",{className:"modal-title",children:(0,u.ag)("user.new.titleModal")}),(0,x.jsx)("button",{type:"button",className:"close","data-dismiss":"modal",children:(0,x.jsx)("span",{children:"\xd7"})})]}),(0,x.jsx)("div",{className:"modal-body",children:(0,x.jsx)(m.Z,{saveLoading:r,onSubmit:Z,onCancel:function(){window.$(t.current).modal("hide")},modal:!0,single:!0})})]})})}),document.getElementById("modal-root"))},Z=n(49513),b=n(43270),j=n(45788),p=n(15021);var v=function(e){var t=(0,b.Gc)(),n=t.setValue,i=t.getValues,c=(0,o.useState)(!1),d=(0,a.Z)(c,2),u=d[0],m=d[1],h=(0,j.v9)(p.Z.selectPermissionToCreate);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Z.Z,(0,s.Z)((0,s.Z)({},e),{},{fetchFn:function(e,t){return l.Z.fetchUserAutocomplete(e,t)},mapper:{toAutocomplete:function(e){if(!e)return null;if(e.fullName||e.email){var t=e.email;return e.fullName&&(t="".concat(e.fullName," <").concat(e.email,">")),{value:e.id,label:t}}return{value:e.id,label:e.label}},toValue:function(e){return e?{id:e.value,label:e.label}:null}},onOpenModal:function(){return m(!0)},hasPermissionToCreate:h})),u&&(0,x.jsx)(f,{visible:u,onClose:function(){return m(!1)},onSuccess:function(t){var s=e.name,a=e.mode;n(s,a&&"multiple"===a?[].concat((0,r.Z)(i()[s]||[]),[t]):t),m(!1)}})]})}},1296:function(e,t,n){n(47313);var s=n(28303),r=n(45788),a=n(15021),o=n(46417);t.Z=function(e){var t=(0,r.v9)(a.Z.selectPermissionToRead),n=function(){var t=e.value;return t?Array.isArray(t)?t:[t]:[]},l=function(e){return e?e.fullName?"".concat(e.fullName," <").concat(e.email,">"):e.email:null};return n().length?(0,o.jsx)(o.Fragment,{children:n().map((function(e){return n=e,t?(0,o.jsx)("div",{children:(0,o.jsx)(s.rU,{className:"btn btn-link",to:"/user/".concat(n.id),children:l(n)})},n.id):(0,o.jsx)("div",{children:l(n)},n.id);var n}))}):null}},22102:function(e,t,n){var s=n(1413),r=n(45987),a=n(46123),o=n.n(a),l=n(47313),i=n(68524),c=n(46417),d=["bsPrefix","fluid","as","className"],u=l.forwardRef((function(e,t){var n=e.bsPrefix,a=e.fluid,l=void 0!==a&&a,u=e.as,m=void 0===u?"div":u,h=e.className,x=(0,r.Z)(e,d),f=(0,i.vE)(n,"container"),Z="string"===typeof l?"-".concat(l):"-fluid";return(0,c.jsx)(m,(0,s.Z)((0,s.Z)({ref:t},x),{},{className:o()(h,l?"".concat(f).concat(Z):f)}))}));u.displayName="Container",t.Z=u}}]);